<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tclap: StdOutput.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">tclap</a></div>
<h1>StdOutput.h</h1><a href="StdOutput_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00002 <span class="comment">/****************************************************************************** </span>
00003 <span class="comment"> * </span>
00004 <span class="comment"> *  file:  StdOutput.h</span>
00005 <span class="comment"> * </span>
00006 <span class="comment"> *  Copyright (c) 2004, Michael E. Smoot</span>
00007 <span class="comment"> *  All rights reverved.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> *  See the file COPYING in the top directory of this distribution for</span>
00010 <span class="comment"> *  more information.</span>
00011 <span class="comment"> *  </span>
00012 <span class="comment"> *  THE SOFTWARE IS PROVIDED _AS IS_, WITHOUT WARRANTY OF ANY KIND, EXPRESS </span>
00013 <span class="comment"> *  OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, </span>
00014 <span class="comment"> *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL </span>
00015 <span class="comment"> *  THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER </span>
00016 <span class="comment"> *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING </span>
00017 <span class="comment"> *  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER </span>
00018 <span class="comment"> *  DEALINGS IN THE SOFTWARE.  </span>
00019 <span class="comment"> *  </span>
00020 <span class="comment"> *****************************************************************************/</span> 
00021 
00022 <span class="preprocessor">#ifndef TCLAP_STDCMDLINEOUTPUT_H</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#define TCLAP_STDCMDLINEOUTPUT_H</span>
00024 <span class="preprocessor"></span>
00025 <span class="preprocessor">#include &lt;string&gt;</span>
00026 <span class="preprocessor">#include &lt;vector&gt;</span>
00027 <span class="preprocessor">#include &lt;list&gt;</span>
00028 <span class="preprocessor">#include &lt;iostream&gt;</span>
00029 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00030 
00031 <span class="preprocessor">#include &lt;<a class="code" href="CmdLineInterface_8h.html">tclap/CmdLineInterface.h</a>&gt;</span>
00032 <span class="preprocessor">#include &lt;<a class="code" href="CmdLineOutput_8h.html">tclap/CmdLineOutput.h</a>&gt;</span>
00033 <span class="preprocessor">#include &lt;<a class="code" href="XorHandler_8h.html">tclap/XorHandler.h</a>&gt;</span>
00034 <span class="preprocessor">#include &lt;<a class="code" href="Arg_8h.html">tclap/Arg.h</a>&gt;</span>
00035 
00036 <span class="keyword">namespace </span>TCLAP {
00037 
<a name="l00042"></a><a class="code" href="classTCLAP_1_1StdOutput.html">00042</a> <span class="keyword">class </span><a class="code" href="classTCLAP_1_1StdOutput.html">StdOutput</a> : <span class="keyword">public</span> <a class="code" href="classTCLAP_1_1CmdLineOutput.html">CmdLineOutput</a>
00043 {
00044 
00045     <span class="keyword">public</span>:
00046 
00052         <span class="keyword">virtual</span> <span class="keywordtype">void</span> usage(<a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; c);
00053 
00059         <span class="keyword">virtual</span> <span class="keywordtype">void</span> version(<a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; c);
00060 
00067         <span class="keyword">virtual</span> <span class="keywordtype">void</span> failure(<a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; c, 
00068                              <a class="code" href="classTCLAP_1_1ArgException.html">ArgException</a>&amp; e );
00069 
00070     <span class="keyword">protected</span>:
00071 
00077         <span class="keywordtype">void</span> _shortUsage( <a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; c, std::ostream&amp; os ) <span class="keyword">const</span>;
00078 
00085         <span class="keywordtype">void</span> _longUsage( <a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; c, std::ostream&amp; os ) <span class="keyword">const</span>;
00086 
00098         <span class="keywordtype">void</span> spacePrint( std::ostream&amp; os, 
00099                          <span class="keyword">const</span> std::string&amp; s, 
00100                          <span class="keywordtype">int</span> maxWidth, 
00101                          <span class="keywordtype">int</span> indentSpaces, 
00102                          <span class="keywordtype">int</span> secondLineOffset ) <span class="keyword">const</span>;
00103 
00104 };
00105 
00106 
<a name="l00107"></a><a class="code" href="classTCLAP_1_1StdOutput.html#a1">00107</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> StdOutput::version(<a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; _cmd) 
00108 {
00109     std::string progName = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a9">getProgramName</a>();
00110     std::string <a class="code" href="classTCLAP_1_1StdOutput.html#a1">version</a> = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a8">getVersion</a>();
00111 
00112     std::cout &lt;&lt; std::endl &lt;&lt; progName &lt;&lt; <span class="stringliteral">"  version: "</span> 
00113               &lt;&lt; version &lt;&lt; std::endl &lt;&lt; std::endl;
00114 }
00115 
<a name="l00116"></a><a class="code" href="classTCLAP_1_1StdOutput.html#a0">00116</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> StdOutput::usage(<a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; _cmd ) 
00117 {
00118     std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"USAGE: "</span> &lt;&lt; std::endl &lt;&lt; std::endl; 
00119 
00120     <a class="code" href="classTCLAP_1_1StdOutput.html#b0">_shortUsage</a>( _cmd, std::cout );
00121 
00122     std::cout &lt;&lt; std::endl &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"Where: "</span> &lt;&lt; std::endl &lt;&lt; std::endl;
00123 
00124     <a class="code" href="classTCLAP_1_1StdOutput.html#b1">_longUsage</a>( _cmd, std::cout );
00125 
00126     std::cout &lt;&lt; std::endl; 
00127 
00128 }
00129 
<a name="l00130"></a><a class="code" href="classTCLAP_1_1StdOutput.html#a2">00130</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> StdOutput::failure( <a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; _cmd,
00131                                 <a class="code" href="classTCLAP_1_1ArgException.html">ArgException</a>&amp; e ) 
00132 {
00133     std::string progName = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a9">getProgramName</a>();
00134 
00135     std::cerr &lt;&lt; <span class="stringliteral">"PARSE ERROR: "</span> &lt;&lt; e.<a class="code" href="classTCLAP_1_1ArgException.html#a3">argId</a>() &lt;&lt; std::endl
00136               &lt;&lt; <span class="stringliteral">"             "</span> &lt;&lt; e.<a class="code" href="classTCLAP_1_1ArgException.html#a2">error</a>() &lt;&lt; std::endl &lt;&lt; std::endl;
00137 
00138     <span class="keywordflow">if</span> ( _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a14">hasHelpAndVersion</a>() )
00139     {
00140         std::cerr &lt;&lt; <span class="stringliteral">"Brief USAGE: "</span> &lt;&lt; std::endl;
00141 
00142         <a class="code" href="classTCLAP_1_1StdOutput.html#b0">_shortUsage</a>( _cmd, std::cerr ); 
00143 
00144         std::cerr &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"For complete USAGE and HELP type: "</span> 
00145                   &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; progName &lt;&lt; <span class="stringliteral">" --help"</span> 
00146                   &lt;&lt; std::endl &lt;&lt; std::endl;
00147     }
00148     <span class="keywordflow">else</span>
00149         <a class="code" href="classTCLAP_1_1StdOutput.html#a0">usage</a>(_cmd);
00150 
00151 }
00152 
<a name="l00153"></a><a class="code" href="classTCLAP_1_1StdOutput.html#b0">00153</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> StdOutput::_shortUsage( <a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; _cmd, 
00154                                     std::ostream&amp; os )<span class="keyword"> const</span>
00155 <span class="keyword"></span>{
00156     std::list&lt;Arg*&gt; argList = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a10">getArgList</a>();
00157     std::string progName = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a9">getProgramName</a>();
00158     <a class="code" href="classTCLAP_1_1XorHandler.html">XorHandler</a> xorHandler = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a11">getXorHandler</a>();
00159     std::vector&lt; std::vector&lt;Arg*&gt; &gt; xorList = xorHandler.<a class="code" href="classTCLAP_1_1XorHandler.html#a6">getXorList</a>();
00160 
00161     std::string s = progName + <span class="stringliteral">" "</span>;
00162 
00163     <span class="comment">// first the xor</span>
00164     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; static_cast&lt;unsigned int&gt;(i) &lt; xorList.size(); i++ )
00165     {
00166         s += <span class="stringliteral">" {"</span>;
00167         <span class="keywordflow">for</span> ( <a class="code" href="namespaceTCLAP.html#a1">ArgVectorIterator</a> it = xorList[i].begin(); 
00168                         it != xorList[i].end(); it++ )
00169             s += (*it)-&gt;shortID() + <span class="stringliteral">"|"</span>;
00170 
00171         s[s.length()-1] = <span class="charliteral">'}'</span>;
00172     }
00173 
00174     <span class="comment">// then the rest</span>
00175     <span class="keywordflow">for</span> (<a class="code" href="namespaceTCLAP.html#a0">ArgListIterator</a> it = argList.begin(); it != argList.end(); it++)
00176         <span class="keywordflow">if</span> ( !xorHandler.<a class="code" href="classTCLAP_1_1XorHandler.html#a5">contains</a>( (*it) ) )
00177             s += <span class="stringliteral">" "</span> + (*it)-&gt;shortID();
00178 
00179     <span class="comment">// if the program name is too long, then adjust the second line offset </span>
00180     <span class="keywordtype">int</span> secondLineOffset = static_cast&lt;int&gt;(progName.length()) + 2;
00181     <span class="keywordflow">if</span> ( secondLineOffset &gt; 75/2 )
00182             secondLineOffset = static_cast&lt;int&gt;(75/2);
00183 
00184     <a class="code" href="classTCLAP_1_1StdOutput.html#b2">spacePrint</a>( std::cout, s, 75, 3, secondLineOffset );
00185 }
00186 
<a name="l00187"></a><a class="code" href="classTCLAP_1_1StdOutput.html#b1">00187</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> StdOutput::_longUsage( <a class="code" href="classTCLAP_1_1CmdLineInterface.html">CmdLineInterface</a>&amp; _cmd, 
00188                                    std::ostream&amp; os )<span class="keyword"> const</span>
00189 <span class="keyword"></span>{
00190     std::list&lt;Arg*&gt; argList = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a10">getArgList</a>();
00191     std::string message = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a13">getMessage</a>();
00192     <a class="code" href="classTCLAP_1_1XorHandler.html">XorHandler</a> xorHandler = _cmd.<a class="code" href="classTCLAP_1_1CmdLineInterface.html#a11">getXorHandler</a>();
00193     std::vector&lt; std::vector&lt;Arg*&gt; &gt; xorList = xorHandler.<a class="code" href="classTCLAP_1_1XorHandler.html#a6">getXorList</a>();
00194 
00195     <span class="comment">// first the xor </span>
00196     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; static_cast&lt;unsigned int&gt;(i) &lt; xorList.size(); i++ )
00197     {
00198         <span class="keywordflow">for</span> ( <a class="code" href="namespaceTCLAP.html#a1">ArgVectorIterator</a> it = xorList[i].begin(); 
00199               it != xorList[i].end(); 
00200               it++ )
00201         {
00202             <a class="code" href="classTCLAP_1_1StdOutput.html#b2">spacePrint</a>( os, (*it)-&gt;longID(), 75, 3, 3 );
00203             <a class="code" href="classTCLAP_1_1StdOutput.html#b2">spacePrint</a>( os, (*it)-&gt;getDescription(), 75, 5, 0 );
00204 
00205             <span class="keywordflow">if</span> ( it+1 != xorList[i].end() )
00206                 <a class="code" href="classTCLAP_1_1StdOutput.html#b2">spacePrint</a>(os, <span class="stringliteral">"-- OR --"</span>, 75, 9, 0);
00207         }
00208         os &lt;&lt; std::endl &lt;&lt; std::endl;
00209     }
00210 
00211     <span class="comment">// then the rest</span>
00212     <span class="keywordflow">for</span> (<a class="code" href="namespaceTCLAP.html#a0">ArgListIterator</a> it = argList.begin(); it != argList.end(); it++)
00213         <span class="keywordflow">if</span> ( !xorHandler.<a class="code" href="classTCLAP_1_1XorHandler.html#a5">contains</a>( (*it) ) )
00214         {
00215             <a class="code" href="classTCLAP_1_1StdOutput.html#b2">spacePrint</a>( os, (*it)-&gt;longID(), 75, 3, 3 ); 
00216             <a class="code" href="classTCLAP_1_1StdOutput.html#b2">spacePrint</a>( os, (*it)-&gt;getDescription(), 75, 5, 0 ); 
00217             os &lt;&lt; std::endl;
00218         }
00219 
00220     os &lt;&lt; std::endl;
00221 
00222     <a class="code" href="classTCLAP_1_1StdOutput.html#b2">spacePrint</a>( os, message, 75, 3, 0 );
00223 }
00224 
<a name="l00225"></a><a class="code" href="classTCLAP_1_1StdOutput.html#b2">00225</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> StdOutput::spacePrint( std::ostream&amp; os, 
00226                                    <span class="keyword">const</span> std::string&amp; s, 
00227                                    <span class="keywordtype">int</span> maxWidth, 
00228                                    <span class="keywordtype">int</span> indentSpaces, 
00229                                    <span class="keywordtype">int</span> secondLineOffset )<span class="keyword"> const</span>
00230 <span class="keyword"></span>{
00231     <span class="keywordtype">int</span> len = static_cast&lt;int&gt;(s.length());
00232 
00233     <span class="keywordflow">if</span> ( (len + indentSpaces &gt; maxWidth) &amp;&amp; maxWidth &gt; 0 )
00234     {
00235         <span class="keywordtype">int</span> allowedLen = maxWidth - indentSpaces;
00236         <span class="keywordtype">int</span> start = 0;
00237         <span class="keywordflow">while</span> ( start &lt; len )
00238         {
00239             <span class="comment">// find the substring length</span>
00240             <span class="keywordtype">int</span> stringLen = std::min( len - start, allowedLen );
00241 
00242             <span class="comment">// trim the length so it doesn't end in middle of a word</span>
00243             <span class="keywordflow">if</span> ( stringLen == allowedLen )
00244                 <span class="keywordflow">while</span> ( s[stringLen+start] != <span class="charliteral">' '</span> &amp;&amp; 
00245                         s[stringLen+start] != <span class="charliteral">','</span> &amp;&amp;
00246                         s[stringLen+start] != <span class="charliteral">'|'</span> &amp;&amp;
00247                         stringLen &gt;= 0 )
00248                     stringLen--;
00249     
00250             <span class="comment">// ok, the word is longer than the line, so just split </span>
00251             <span class="comment">// wherever the line ends</span>
00252             <span class="keywordflow">if</span> ( stringLen &lt;= 0 )
00253                 stringLen = allowedLen;
00254 
00255             <span class="comment">// check for newlines</span>
00256             <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; stringLen; i++ )
00257                 <span class="keywordflow">if</span> ( s[start+i] == <span class="charliteral">'\n'</span> )
00258                     stringLen = i+1;
00259 
00260             <span class="comment">// print the indent </span>
00261             <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; indentSpaces; i++ )
00262                 os &lt;&lt; <span class="stringliteral">" "</span>;
00263 
00264             <span class="keywordflow">if</span> ( start == 0 )
00265             {
00266                 <span class="comment">// handle second line offsets</span>
00267                 indentSpaces += secondLineOffset;
00268 
00269                 <span class="comment">// adjust allowed len</span>
00270                 allowedLen -= secondLineOffset;
00271             }
00272 
00273             os &lt;&lt; s.substr(start,stringLen) &lt;&lt; std::endl;
00274 
00275             <span class="comment">// so we don't start a line with a space</span>
00276             <span class="keywordflow">while</span> ( s[stringLen+start] == <span class="charliteral">' '</span> &amp;&amp; start &lt; len )
00277                 start++;
00278             
00279             start += stringLen;
00280         }
00281     }
00282     <span class="keywordflow">else</span>
00283     {
00284         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; indentSpaces; i++ )
00285                 os &lt;&lt; <span class="stringliteral">" "</span>;
00286         os &lt;&lt; s &lt;&lt; std::endl;
00287     }
00288 }
00289 
00290 } <span class="comment">//namespace TCLAP</span>
00291 <span class="preprocessor">#endif </span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jul 7 17:11:24 2009 for tclap by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
